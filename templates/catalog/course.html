{% extends "3col.html" %}
{% load humanize %}
{% load custommardown %}
{% load compress %}

{% block title %}{{ course.slug|upper }}{% endblock %}
t²
{% block center-col %}
<div class="row">
  <div class="large-10 columns">
    <h1 >{{ course.slug|upper }}{% if course in request.user.followed_courses %} <i class="fi-check green"></i>{% endif %}</h1>
    <h2>{{ course.name }}</h2>
  </div>
  <div class="large-2 columns">
    <br/>
    <a href="{{ course.gehol_url }}" class="button expand radius" target="_blank">Horaire sur GeHol</a>
  </div>
</div>

<div class="row">
  <div class="large-12 medium-12 columns">
    {% for document in documents %}
      <div class="row course-row"
        node-keywords="{% for kw in document.tags.all %}{{kw}} {% endfor %}"
        node-type="Document"
      >
        {% if document.state == 'DONE' %}
          <a href="{% url 'document_show' document.id %}">
            <i class="fi-page-copy round-icon big"></i>
          </a>
        {% else %}
          <i class="fi-loop round-icon big"></i>
        {% endif %}
        <div class="course-row-content">
          <h5>
            {% if document.state == "DONE" %}
              <a href="{% url 'document_show' document.id %}"> {{ document.name }} </a>
            {% else %}
              {{ document.name }}
            {% endif %}
            <small>par {{ document.user.name }}</small>
          </h5>
          {% if document.description %}
            <p>{{ document.description|truncatechars:200 }}</p>
          {% endif %}
          {# <a href="{% url 'document_edit' document.id %}"><i class="fi-widget"></i> Editer</a> #}
          <div class="course-content-last-line">
            <i class="fi-page-filled"></i>  {{ document.pages }} page{{ document.pages|pluralize }}
            <i class="fi-clock"></i> Uploadé le {{ document.date|date:"d F Y" }}
            {% if document.tags.all %}<i class="fi-pricetag-multiple"></i> {% endif %}
            {% for kw in document.tags.all%}
              <a data-id="{{kw.id}}" href="#"
                 style="background-color: {{kw.color}}; border: solid 2px {{kw.color}};"
                 class="radius label tag-item">
                {{kw}}
              </a>
            {% endfor %}
          </div>
        </div>
      </div>
    {% empty %}
      <h3>Il n’y a encore rien dans ce cours…</h3>
      <p>Personne n’est encore passé ici on dirait.<br>
        Vous pourriez poser une question ou encore uploader un document en cliquant sur les boutons ci-dessus. </p>
    {% endfor %}

  </div>
</div>
{% endblock %}

{% block right-col %}
<div class="row">
  <div class="large-12 columns">
    <br>
    <a class="button expand radius" href="{% url 'document_put' course.slug %}">Uploader un fichier</a>
    <a class="button expand radius" href="{% url 'thread_put' course.slug %}">Poser une question</a>
    {% if course in request.user.followed_courses.all %}
      <a class="button expand alert radius" href="{% url 'leave_course' course.slug %}">
        <i class="fi-x"></i> Se désabonner
      </a>
    {% else %}
      <a class="button expand success radius" href="{% url 'join_course' course.slug %}">
        <i class="fi-check"></i> S’abonner
      </a>
    {% endif %}
    {% if followers > 1 %}
      <small>{{followers}} personnes sont abonnées à ce cours.</small>
    {% endif %}
  </div>
</div>

{% endblock %}
