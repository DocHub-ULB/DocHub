{% extends "3col.html" %}

{% load humanize %}
{% load custommardown %}
{% load activity_tags %}
{% load has_perm_on %}

{% block title %}{{ course.slug|upper }}{% endblock %}

{% block center-col %}
<div class="row">
  <div class="large-10 columns">
    <h1 >
      {{ course.slug|upper }}
      {% if request.user|is_following:course %}
        <i class="fi-check green"></i>
      {% endif %}
    </h1>
    <h2>{{ course.name }}</h2>
  </div>
</div>
<div class="row">
  {% with documents=documents.all threads=threads.all %}
    <div class="large-12 medium-12 columns">
      <ul class="tabs" data-tab>
        <li class="tab-title"><a href="#documents">Documents ({{documents.count}})</a></li>
        <li class="tab-title">
          <a href="#threads">
            Discussions ({{threads.count}})
            &nbsp;<span class="round label">new</span>
          </a>
        </li>
        <li class="tab-title active">
          <a href="#questions">Questions d'examens ({{questions.count}})
            &nbsp;<span class="round alert label">new <i class="fi-star"></i></span>
          </a>
        </li>
      </ul>
      <div class="tabs-content">
        <div class="content" id="documents" data-id="{{ course.slug }}">
          {% include "catalog/course_documents.html" %}
        </div>
        <div class="content" id="threads">
          {% include "catalog/course_threads.html" %}
        </div>
        <div class="content active" id="questions">
          {% include "catalog/course_questions.html" %}
        </div>
      </div>
    </div>
  {% endwith %}
</div>
{% endblock %}

{% block right-col %}
<div class="row">
  <div class="large-12 columns">
    <br>
    <a class="button expand" href="{% url 'document_put' course.slug %}">Uploader un fichier</a>
    {% if request.user|is_following:course %}
      <a class="button expand alert" href="{% url 'leave_course' course.slug %}">
        <i class="fi-x"></i> Se désabonner
      </a>
    {% else %}
      <a class="button expand success" href="{% url 'join_course' course.slug %}">
        <i class="fi-check"></i> S’abonner
      </a>
    {% endif %}
    {% if followers_count > 1 %}
      <small>{{followers_count}} personnes sont abonnées à ce cours.</small>
    {% endif %}
  </div>
</div>
{% endblock %}

{% block script %}
<script type="text/javascript">
    loadCourseViewer('documents');
</script>
{% endblock %}
